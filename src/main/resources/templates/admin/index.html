<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html lang="zh-cn" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <base th:href="@{/}" href="">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <title>立衡脊柱-门户主页</title>
    <link rel="stylesheet" type="text/css" th:href="@{/lib/semantic/semantic.min.css}" href="../../static/lib/semantic/semantic.min.css" />
    <link rel="stylesheet" th:href="@{/lib/toastr/toastr.css}" href="../../static/lib/toastr/toastr.css" />
    <link rel="stylesheet" type="text/css" th:href="@{/admin/css/admin.css}" href="../../static/admin/css/admin.css" />
    <script type="text/javascript" th:src="@{/lib/jquery-1.11.1.min.js}" src="../../static/lib/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" th:src="@{/lib/jquery.tmpl.min.js}" src="../../static/lib/jquery.tmpl.min.js"></script>
    <script type="text/javascript" th:src="@{/lib/date.format.js}" src="../../static/lib/date.format.js"></script>
    <script type="text/javascript" th:src="@{/lib/semantic/semantic.min.js}" src="../../static/lib/semantic/semantic.min.js"></script>
    <script th:src="@{/lib/toastr/toastr.js}" src="../../static/lib/toastr/toastr.js"></script>
    <script type="text/javascript" th:src="@{/admin/js/admin.js}" src="../../static/admin/js/admin.js"></script>
    <script id="imageItemTpl" type="text/x-jquery-tmpl">
        <div class="card">
            <a class="image">
                <img src="${$item.pathHuge}${uuidName}" data-src="${path}${uuidName}">
            </a>
            <div class="content">
                <div class="ui checkbox">
                    <input type="checkbox" name="image">
                    <label>${name}</label>
                </div>
            </div>
        </div>
    </script>
    <script id="bigImgItem" type="text/x-jquery-tmpl">
        <div class="item">
            <div class="ui segment">
                <img class="ui image" src="${imgUrl}">
                <div class="ui divider"></div>
                <div class="right floated compact ui red button btn-del" data-id="${id}">删除</div>
            </div>
        </div>
    </script>
    <script id="hotNewsItemTpl" type="text/x-jquery-tmpl">
        <div class="card">
            <div class="image">
                <img src="${imgUrl}">
            </div>
            <div class="content">
                <div class="header"></div>
                <div class="description ad-hot-news-content"></div>
            </div>
            <div class="extra content">
                <span class="right floated">
                    <div class="ui small red compact button btn-hot-news-del" data-id="${id}">删除</div>
                </span>
                <span>
                    <div class="ui small primary compact button btn-hot-news-edit" data-id="${id}">编辑</div>
                </span>
            </div>
        </div>
    </script>
    <script id="moreNewsItemTpl" type="text/x-jquery-tmpl">
        <div class="item">
            <div class="right floated compact ui red button btn-more-news-del" data-id="${id}">删除</div>
            <i class="linkify icon"></i>
            <div class="content">
                <div class="header">${title}</div>
            </div>
        </div>
    </script>
    <script id="articleItemTpl" type="text/x-jquery-tmpl">
        <tr>
            <td class="collapsing">
                <div class="ui checkbox">
                    <input type="checkbox" value="${id}">
                    <label></label>
                </div>
            </td>
            <td class="article-name">${name}</td>
            <td>${createDate}</td>
            <td>${username}</td>
        </tr>
    </script>
</head>

<body class="admin-index">
    <div th:with="uri=${#httpServletRequest.requestURI}" th:fragment="sidebar-menu" class="ui left thin vertical inverted labeled icon sidebar menu ad-index-menu">
        <a th:classappend="(${#strings.contains(uri, '/admin/index')} or ${#strings.endsWith(uri,'/admin/')} or ${#strings.endsWith(uri,'/admin')}) ? 'active' : ''" class="item" th:href="@{/admin}" href="index.html"> <i class="home icon"></i> 门户主页
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/about')} ? 'active' : ''" class="item" th:href="@{/admin/about}" href="about.html"> <i class="info circle icon"></i> 关于我们
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/feature')} ? 'active' : ''" class="item" th:href="@{/admin/feature}" href="feature.html"> <i class="dashboard icon"></i> 疗法特色
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/case')} ? 'active' : ''" class="item" th:href="@{/admin/case}" href="case.html"> <i class="smile icon"></i> 康复案例
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/product')} ? 'active' : ''" class="item" th:href="@{/admin/product}" href="product.html"> <i class="idea icon"></i> 专利产品
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/env')} ? 'active' : ''" class="item" th:href="@{/admin/env}" href="env.html"> <i class="grid layout icon"></i> 店内环境
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/team')} ? 'active' : ''" class="item" th:href="@{/admin/team}" href="team.html"> <i class="doctor icon"></i> 专家团队
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/health')} ? 'active' : ''" class="item" th:href="@{/admin/health}" href="health.html"> <i class="heartbeat icon"></i> 脊柱健康
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/diagnose')} ? 'active' : ''" class="item" th:href="@{/admin/diagnose}" href="diagnose.html"> <i class="treatment icon"></i> 在线诊断
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/contact')} ? 'active' : ''" class="item" th:href="@{/admin/contact}" href="contact.html"> <i class="at icon"></i> 联系我们
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/resource')} ? 'active' : ''" class="item" th:href="@{/admin/resource}" href="resource.html"> <i class="file image outline icon"></i> 资源文件
        </a>
        <a th:classappend="${#strings.contains(uri, '/admin/article')} ? 'active' : ''" class="item" th:href="@{/admin/article}" href="article.html"> <i class="file text outline icon"></i> 文章管理
        </a>
    </div>
    <div th:fragment="top-fixed-menu" class="ui fixed inverted main menu">
        <div class="container">
            <a class="ui button icon item ad-index-btn-menu">
                <i class="content icon"></i> 菜单
            </a>
            <div class="title item">
                <b>立恒脊柱</b> - 后台管理
            </div>
            <div class="right menu">
                <div class="item ui button ad-item-feedback">
                    <div class="" th:attrappend="data-url=${#httpServletRequest.requestURI}">反馈 </div>
                    <form class="hidden" th:action="@{/admin/feedback}" action="" method="post">
                        <input type="hidden" name="url" value="" th:value="${#httpServletRequest.requestURI}" />
                        <input type="hidden" name="name" value="" />
                    </form>
                </div>
                <div class="item ui button">
                    <div class="ad-index-logout">退出 </div>
                    <form class="hidden" th:action="@{/admin/logout}" action="" method="post"></form>
                </div>
            </div>
        </div>
    </div>
    <div class="pusher ad-index-content">
        <div class="ad-index-container">
            <div th:fragment="rail-menu" class="ui dividing close left rail ad-index-rail" style="width:210px;">
                <div class="ui sticky ad-index-sticky">
                    <div th:with="uri=${#httpServletRequest.requestURI}" class="ui vertical pointing menu">
                        <a th:classappend="(${#strings.contains(uri, '/admin/index')} or ${#strings.endsWith(uri,'/admin/')} or ${#strings.endsWith(uri,'/admin')}) ? 'active' : ''" class="item" th:href="@{/admin}" href="index.html">
                            <i class="home icon"></i> 门户主页
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/about')} ? 'active' : ''" class="item" th:href="@{/admin/about}" href="about.html">
                            <i class="info circle icon"></i> 关于我们
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/feature')} ? 'active' : ''" class="item" th:href="@{/admin/feature}" href="feature.html">
                            <i class="dashboard icon"></i> 疗法特色
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/case')} ? 'active' : ''" class="item" th:href="@{/admin/case}" href="case.html">
                            <i class="smile icon"></i> 康复案例
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/product')} ? 'active' : ''" class="item" th:href="@{/admin/product}" href="product.html">
                            <i class="idea icon"></i> 专利产品
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/env')} ? 'active' : ''" class="item" th:href="@{/admin/env}" href="env.html">
                            <i class="grid layout icon"></i> 店内环境
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/team')} ? 'active' : ''" class="item" th:href="@{/admin/team}" href="team.html">
                            <i class="doctor icon"></i> 专家团队
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/health')} ? 'active' : ''" class="item" th:href="@{/admin/health}" href="health.html">
                            <i class="heartbeat icon"></i> 脊柱健康
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/diagnose')} ? 'active' : ''" class="item" th:href="@{/admin/diagnose}" href="diagnose.html">
                            <i class="treatment icon"></i> 在线诊断
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/contact')} ? 'active' : ''" class="item" th:href="@{/admin/contact}" href="contact.html">
                            <i class="at icon"></i> 联系我们
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/resource')} ? 'active' : ''" class="item" th:href="@{/admin/resource}" href="resource.html">
                            <i class="file image outline icon"></i> 资源文件
                        </a>
                        <a th:classappend="${#strings.contains(uri, '/admin/article')} ? 'active' : ''" class="item" th:href="@{/admin/article}" href="article.html">
                            <i class="file text outline icon"></i> 文章管理
                        </a>
                    </div>
                </div>
            </div>
            <div class="context">
                <div class="ui styled fluid accordion">
                    <div class="title">
                        <i class="dropdown icon"></i> 主页 - 使用指导
                    </div>
                    <div class="content">
                        <p>暂无</p>
                    </div>
                </div>
                <h2 class="ui header">
                <i class="settings icon"></i>
                <div class="content">
                    主页设置
                    <div class="sub header">设置门户主页各模块的内容</div>
                </div>
                </h2>
                <div class="ui styled fluid accordion">
                    <div class="title">
                        <i class="dropdown icon"></i> 轮动图
                    </div>
                    <div class="content">
                        <div class="ui segment">
                            <div class="ui primary button ad-add-image" data-for="bigImg">添加</div>
                        </div>
                        <div class="ui divided list big-img-list" th:remove="all-but-first">
                            <div class="item" th:each="bigImg : ${bigImgs}">
                                <div class="ui segment">
                                    <img class="ui image" th:src="${bigImg.imgUrl}">
                                    <div class="ui divider"></div>
                                    <div class="right floated compact ui red button btn-del" th:attrappend="data-id=${bigImg.id}">删除</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="title">
                        <i class="dropdown icon"></i> 热门动态
                    </div>
                    <div class="content">
                        <div class="ui segment">
                            <div class="ui primary button ad-add-image" data-for="hotNews">添加</div>
                        </div>
                        <div class="ui link cards ad-hot-news-list" th:remove="all-but-first">
                            <div class="card" th:each="hotNew : ${hotNews}">
                                <div class="image">
                                    <img th:title="${hotNew.more}" th:alt="${hotNew.link}" src="../../static/landing/img/img1.jpg" title="" th:src="${hotNew.imgUrl}">
                                </div>
                                <div class="content">
                                    <div class="header" th:text="${hotNew.title}"></div>
                                    <div class="description ad-hot-news-content" th:text="${#strings.abbreviate(hotNew.content,65)}"></div>
                                </div>
                                <div class="extra content">
                                    <span class="right floated">
                                        <div class="ui small red compact button btn-hot-news-del" th:attrappend="data-id=${hotNew.id}">删除</div>
                                    </span>
                                    <span>
                                        <div class="ui small primary compact button btn-hot-news-edit" th:attrappend="data-id=${hotNew.id}">编辑</div>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="active title">
                        <i class="dropdown icon"></i> 更多动态
                    </div>
                    <div class="active content">
                        <div class="ui two column stackable grid grid-more-news">
                            <div class="column">
                                <div class="ui segment">
                                    <div class="ui primary button btn-more-news-add" data-col="1">添加</div>
                                </div>
                                <div class="ui segment">
                                    <div class="ui divided list" th:remove="all-but-first">
                                        <div class="item" th:each="moreNew : ${moreNews}" th:if="${moreNew.more == '1'}">
                                            <div class="right floated compact ui red button btn-more-news-del" th:attrappend="data-id=${moreNew.id}">删除</div>
                                            <i class="linkify icon"></i>
                                            <div class="content">
                                                <div class="header" th:text="${moreNew.title}">Justen Kitsune</div>
                                            </div>
                                        </div>
                                        <div class="item">
                                            <div class="right floated compact ui red button btn-more-news-del">删除</div>
                                            <i class="linkify icon"></i>
                                            <div class="content">
                                                <div class="header">Justen Kitsune</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="ui segment">
                                    <div class="ui primary button btn-more-news-add" data-col="2">添加</div>
                                </div>
                                <div class="ui segment">
                                    <div class="ui divided list" th:remove="all-but-first">
                                        <div class="item" th:each="moreNew : ${moreNews}" th:if="${moreNew.more == '2'}">
                                            <div class="right floated compact ui red button btn-more-news-del" th:attrappend="data-id=${moreNew.id}">删除</div>
                                            <i class="linkify icon"></i>
                                            <div class="content">
                                                <div class="header" th:text="${moreNew.title}">Justen Kitsune</div>
                                            </div>
                                        </div>
                                        <div class="item">
                                            <div class="right floated compact ui red button btn-more-news-del">删除</div>
                                            <i class="linkify icon"></i>
                                            <div class="content">
                                                <div class="header">Justen Kitsune</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- hidden form for getting csrf -->
    <form class="hidden ad-csrf">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </form>
    <!-- image select modal -->
    <div class="ui modal ad-images">
        <!-- <i class="close icon"></i> -->
        <div class="header">
            图片选择
        </div>
        <div class="content">
            <div class="ui cards grouped" th:remove="body">
                <div class="card">
                    <a class="image">
                        <img src="../../static/landing/img/img-b1.jpg">
                    </a>
                    <div class="content">
                        <div class="ui checkbox">
                            <input type="checkbox" name="image" checked="checked">
                            <label>图片1</label>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <a class="image">
                        <img src="../../static/landing/img/img-b2.jpg">
                    </a>
                    <div class="content">
                        <div class="ui radio checkbox">
                            <input type="radio" name="image" checked="checked">
                            <label>图片1</label>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <a class="image">
                        <img src="../../static/landing/img/img-b3.jpg">
                    </a>
                    <div class="content">
                        <div class="ui radio checkbox">
                            <input type="radio" name="image" checked="checked">
                            <label>图片1</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="actions">
            <div class="ui cancel negative button">取消</div>
            <div class="ui ok positive button">确定</div>
        </div>
    </div>
    <!-- delete confirm modal -->
    <div class="ui small modal ad-delete-confirm">
        <i class="close icon"></i>
        <div class="header">
            删除确认
        </div>
        <div class="content">
            <p>确定要删除吗?</p>
        </div>
        <div class="actions">
            <div class="ui cancel negative button">取消</div>
            <div class="ui ok positive button">确定</div>
        </div>
    </div>
    <!-- hot news edit modal -->
    <div class="ui small modal ad-news-edit">
        <!-- <i class="close icon"></i> -->
        <div class="header">
            热点动态编辑
        </div>
        <div class="content">
            <div class="ui form segment">
                <div class="field">
                    <label>链接</label>
                    <div class="ui selection dropdown ad-article-list">
                        <div class="default text">动态详细链接</div>
                        <i class="dropdown icon"></i>
                        <input type="hidden" name="link">
                        <div class="menu">
                            <div class="item" data-value="1">文章1</div>
                            <div class="item" data-value="2">文章2</div>
                        </div>
                    </div>
                </div>
                <div class="field">
                    <label>标题</label>
                    <input type="text" name="title" placeholder="动态标题">
                </div>
                <div class="field">
                    <label>描述</label>
                    <textarea name="content" placeholder="动态描述"></textarea>
                </div>
            </div>
        </div>
        <div class="actions">
            <div class="ui cancel negative button">取消</div>
            <div class="ui ok positive button">确定</div>
        </div>
    </div>
    <!-- news select modal -->
    <div class="ui small modal ad-news-select">
        <div class="header">
            文章选择
        </div>
        <div class="content">
            <table class="ui compact unstackable striped definition table table-news-select">
                <thead>
                    <tr>
                        <th></th>
                        <th>文章名</th>
                        <th>发布日期</th>
                        <th>发布者</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="collapsing">
                            <div class="ui checkbox">
                                <input type="checkbox" value="1">
                                <label></label>
                            </div>
                        </td>
                        <td class="article-name">John Lilki</td>
                        <td>September 14, 2013</td>
                        <td>jhlilk22@yahoo.com</td>
                    </tr>
                    <tr>
                        <td class="collapsing">
                            <div class="ui checkbox">
                                <input type="checkbox" value="2">
                                <label></label>
                            </div>
                        </td>
                        <td>Jamie Harington</td>
                        <td>January 11, 2014</td>
                        <td>jamieharingonton@yahoo.com</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="actions">
            <div class="ui cancel negative button">取消</div>
            <div class="ui ok positive button">确定</div>
        </div>
    </div>
    <script type="text/javascript">
    jQuery(document).ready(function($) {
        $('.ad-images > .content').on('click', '.image', function(event) {
            $(this).parents('.card').find('.ui.checkbox').checkbox("toggle");
        });
        $('.ui.dropdown.ad-article-list').dropdown({
            onChange: function(value, text, $choice) {
                $('.ad-news-edit input[name="title"]').val(text);
            }
        });

        $('.grid-more-news').on('click', '.btn-more-news-del', function(event) {
            var $btn = $(this);
            $('.ad-delete-confirm').modal({
                onApprove: function() {
                    $.post('admin/settings/delete', {
                        id: $btn.attr('data-id')
                    }, function(data, textStatus, xhr) {
                        if (data.success) {
                            $btn.closest('.item').remove();
                            toastr.success('删除成功!');
                        } else {
                            toastr.error('删除失败!');
                        }
                    });
                }
            }).modal('show');
        });

        $('.grid-more-news').on('click', '.btn-more-news-add', function(event) {
            var $btn = $(this);

            $('.ad-news-select').modal({
                onApprove: function() {

                    //get selected news
                    var linkIds = [];
                    $('.table-news-select input:checkbox:checked').each(function(index, el) {
                        linkIds.push({
                            link: $(el).val(),
                            title: $(el).parents('tr').find('td[class="article-name"]').text()
                        });
                    });

                    if (linkIds.length == 0) {
                        toastr.error('没有选择任何项目!');
                        return false;
                    }

                    $.each(linkIds, function(index, val) {
                        $.post('admin/settings/save', {
                            page: 'index',
                            module: 'moreNews',
                            title: val.title,
                            link: val.link,
                            more: $btn.attr('data-col')
                        }, function(data, textStatus, xhr) {
                            if (data.success) {
                                $('#moreNewsItemTpl').tmpl(data.data).appendTo($btn.closest('.column').find('.list'));
                                toastr.success('保存成功!');
                            } else {
                                toastr.error('保存失败!');
                            }
                        });
                    });

                },
                onShow: function() {
                    $.post('admin/article/list', {
                            timestamp: new Date().getTime()
                        },
                        function(data, textStatus, xhr) {
                            if (data.success) {

                                $.each(data.data, function(index, val) {
                                     val['createDate'] = new Date(val.createDate).format('yyyy/MM/dd hh:mm:ss');
                                });

                                $('#articleItemTpl').tmpl(data.data).appendTo($('.ad-news-select table > tbody').empty());
                                $('.ui.checkbox').checkbox();
                            } else {
                                toastr.error('查询文章失败!');
                                return false;
                            }
                        });
                },
                onVisible: function() {
                    $('.ad-news-select.modal').modal('refresh');
                }
            }).modal('show');
        });

        $('.big-img-list').on('click', '.btn-del', function(event) {
            var $btn = $(this);
            $('.ad-delete-confirm').modal({
                onApprove: function() {
                    $.post('admin/settings/delete', {
                        id: $btn.attr('data-id')
                    }, function(data, textStatus, xhr) {
                        if (data.success) {
                            $btn.parents('.item').remove();
                            toastr.success('删除成功!');
                        } else {
                            toastr.error('删除失败!');
                        }
                    });
                }
            }).modal('show');
        });

        $('.ad-hot-news-list').on('click', '.btn-hot-news-edit', function(event) {
            var $btn = $(this);

            $('.ad-news-edit').modal({
                onApprove: function() {
                    $.post('admin/settings/update', {
                        id: $btn.attr('data-id'),
                        title: $('.ad-news-edit input[name="title"]').val(),
                        content: $('.ad-news-edit textarea[name="content"]').val(),
                        link: $('.ui.dropdown.ad-article-list').dropdown('get value'),
                        more: $('.ui.dropdown.ad-article-list').dropdown('get text')
                    }, function(data, textStatus, xhr) {
                        if (data.success) {
                            $btn.parents(".card").find('.content .header').text(data.data.title);
                            $btn.parents(".card").find('.content .description').text(Utils.abbreviate(data.data.content, 65));
                            $btn.parents(".card").find('.image img').attr({
                                "title": data.data.more,
                                'alt': data.data.link
                            });
                            toastr.success('更新成功!');
                        } else {
                            toastr.error('更新失败!');
                        }
                    });
                },
                onShow: function() {
                    $.post('admin/article/list', {
                            timestamp: new Date().getTime()
                        },
                        function(data, textStatus, xhr) {
                            if (data.success) {
                                $.tmpl('<div class="item" data-value="${id}">${name}</div>', data.data).appendTo($('.ad-article-list .menu').empty());
                                //$('.ui.dropdown.ad-article-list').dropdown();

                                $.post('admin/settings/find', {
                                    id: $btn.attr('data-id')
                                }, function(data, textStatus, xhr) {
                                    if (data.success) {
                                        $('.ui.dropdown.ad-article-list').dropdown('set selected', data.data.link);
                                        $('.ad-news-edit input[name="title"]').val(data.data.title);
                                        $('.ad-news-edit textarea[name="content"]').val(data.data.content);
                                    } else {
                                        toastr.error('查询设置失败!');
                                        return false;
                                    }
                                });
                            } else {
                                toastr.error('查询文章失败!');
                                return false;
                            }
                        });
                }
            }).modal('show');
        });
        $('.ad-hot-news-list').on('click', '.btn-hot-news-del', function(event) {
            var $btn = $(this);
            $('.ad-delete-confirm').modal({
                onApprove: function() {
                    $.post('admin/settings/delete', {
                        id: $btn.attr('data-id')
                    }, function(data, textStatus, xhr) {
                        if (data.success) {
                            $btn.parents('.card').remove();
                            toastr.success('删除成功!');
                        } else {
                            toastr.error('删除失败!');
                        }
                    });
                }
            }).modal('show');
        });

        window.imgSelectedCallback = function(imgUrlArr, module) {
            // save to server db.
            $.each(imgUrlArr, function(index, imgUrl) {
                $.post('admin/settings/save', {
                    page: 'index',
                    module: module,
                    imgUrl: imgUrl
                }, function(data, textStatus, xhr) {
                    if (data.success) {
                        var m = [{
                            id: data.data.id,
                            imgUrl: data.data.imgUrl
                        }];
                        if (module == "bigImg") {
                            $("#bigImgItem").tmpl(m).appendTo($('.big-img-list'));
                        } else if (module == "hotNews") {
                            $('#hotNewsItemTpl').tmpl(m).appendTo($('.ad-hot-news-list'));
                        }

                        toastr.success('设置成功!');
                    } else {
                        toastr.error('设置失败!');
                    }
                });
            });
        };

    });
    </script>
</body>

</html>
